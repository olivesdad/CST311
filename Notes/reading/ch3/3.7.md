# TCP Congestion Control [[AIMD]]

- **Congestion window** denoted as [[cwnd]] imposes a constraint on the rate at which a TCP sender can send traffic into the network. Specifically, the amount of unacknowledged data at a sender may not exceed the minimum of cwnd and [[rwnd]] , that is: $$LastByteSent−LastByteAcked≤min{cwnd, rwnd}$$
What the above means is that cwind and rwind limit the amount of unacked data the sender can dump into the link

- Thus the sender’s send rate is roughly cwnd/RTT bytes/sec.

## How does TCP percieve congestion?
-  Loss even can be defined by
	- Some timeout is reached
	- Sender ecieves 3 duplicat ACKs 
- When there are lost packets it is implied that there is congestion soewhere and cwind should be decreased

## How does TCP adjust cwind/rate?
- Acked segments iimply all is well and sender can increase rate
- **Bandwidth Probing** TCP will increase it's send rate until a loss occurs then it wll scale back
-

## TCP congestion-control algorithm,
### 1. Slow Start
- When a TCP connection begins, the value of cwnd is typically initialized to a small value of 1 [[MSS]]  resulting in an initial sending rate of roughly MSS/RTT
- slow-start state, the value of cwnd begins at 1 MSS and increases by 1 MSS every time a transmitted segment is first acknowledged
	- it increases by 1 for each acked segment so we could have something like
		1. send 1mss 
		2. increase to 2 mss if acked
		3. 2 segments are ack'ed so we increase to 4
- If there is a loss due to timeout cwind gets set back to 1 and process restarts
	- and uses seconv var called **ssthresh** (shorthand for “slow start threshold”) to cwnd/2 —half of the value of the congestion window value when congestion was detected. 
	- If the second attempt meets or exceeds ssthresh while doubling Slow start Ends and we go on to COngestion avoidance
- IF there are 3 duplicate acks (meaning a packet was dropped)
	- we will do a fast retransmit and enter Fast recovery
### 2. Congestion  Avoidance
- On entry to the congestion-avoidance state, the value of cwnd is approximately half its value when congestion was last encountered
- This will increas cwind by 1MSS for each cwnd worth of acks
	- IE: , if MSS is 1,460 bytes and cwnd is 14,600 bytes, then 10 segments are being sent within an RTT. For each ACK we will increase cwind by 1/10MSS. SO after all 10 packets have been acked we will have 1 more MSS in cwnd
- This does the same thing Slow Start does when a loss is incurred
### 3. Fast Recovery
- In fast recovery, the value of cwnd is increased by 1 MSS for every duplicate ACK received for the missing segment that caused TCP to enter the fast-recovery state.
- If we get an ack for the lost packet we enter Congestion Avoidance
-